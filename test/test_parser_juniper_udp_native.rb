# test/plugin/test_in_your_own.rb

$LOAD_PATH.unshift File.expand_path('../../lib/fluent/plugin/', __FILE__)
$LOAD_PATH.unshift File.expand_path('../../lib/', __FILE__)

require 'simplecov'
SimpleCov.start do
    add_filter 'cmerror.pb.rb'
    add_filter 'cmerror_data.pb.rb'
    add_filter 'cpu_memory_utilization.pb.rb'
    add_filter 'fabric.pb.rb'
    add_filter 'firewall.pb.rb'
    add_filter 'lib/google'
    add_filter %r{lsp}
    add_filter %r{port}
    add_filter %r{npu}
    add_filter %r{lib/.*pb}
end

#require "coverage.so"
Coverage.start

require 'test/unit'
require 'mocha/test_unit'
require 'fluent/test'
require 'socket'

# your own plugin
require 'parser_juniper_udp_native.rb'
require 'juniper_telemetry_udp_lib.rb'

#SimpleCov.start do
#    add_filter "lib/"
#end

class OCInputTest < Test::Unit::TestCase
    def setup
        Fluent::Test.setup  # this is required to setup router and others
    end

    sub_test_case 'Juniper UDP/native parser' do
        test 'With empty data' do
            jti_msg = mock()
            enterp = mock()
            jnprnet = mock()
            epoc_to_sec = mock()
            jnpr_sensor = mock
            json_txt = {}
            enterp.stubs(:juniperNetworks).returns(jnpr_sensor)
            jnpr_sensor.stubs(:to_json).returns(json_txt)
            jti_msg.stubs(:system_id).returns('DEVICE-A')
            jti_msg.stubs(:timestamp).returns('1234567890909')
            jti_msg.stubs(:enterprise).returns(enterp)
            TelemetryStream.any_instance.stubs(:decode).returns(jti_msg)
            enterp.stubs(:juniperNetworks).returns(json_txt)
            parser = Fluent::TextParser::JuniperJtiParser.new
            assert_equal([], parser.parse({}))
        end
        
        test 'With proper data' do
            jti_msg = mock()
            enterp = mock()
            jnprnet = mock()
            epoc_to_sec = mock()
            jnpr_sensor = mock

            json_txt = {"jnpr_interface_ext": {"interface_stats": [{"name":"Kernel"}, {"name":"RE"}]}}
            enterp.stubs(:juniperNetworks).returns(jnpr_sensor)
            jnpr_sensor.stubs(:to_json).returns(json_txt)
            jti_msg.stubs(:system_id).returns('DEVICE-A')
            jti_msg.stubs(:timestamp).returns('1234567890909')
            jti_msg.stubs(:enterprise).returns(enterp)
            
            TelemetryStream.any_instance.stubs(:decode).returns(jti_msg)
            enterp.stubs(:juniperNetworks).returns(json_txt)

            parser = Fluent::TextParser::JuniperJtiParser.new

            count = 0
            hostname = Socket.gethostname
            parser.parse({}) {|time, record|
                
                case count
                    when 0
                        assert_equal(1234567890, time)
                        assert_equal({"interface_stats.name"=>"Kernel", "device"=>"DEVICE-A", "host"=>hostname, "sensor_name"=>"jnpr_interface_ext", "time"=>1234567890909}, record)
                    when 1
                        assert_equal(1234567890, time)
                        assert_equal({"interface_stats.name"=>"RE", "device"=>"DEVICE-A", "host"=>hostname, "sensor_name"=>"jnpr_interface_ext", "time"=>1234567890909}, record)
                end
                count += 1
            }
        end
        test 'With QMON data' do
            jti_msg = mock()
            enterp = mock()
            jnprnet = mock()
            epoc_to_sec = mock()
            jnpr_sensor = mock

            #json_txt = {"jnpr_interface_ext": {"interface_stats": [{"name":"Kernel"}, {"name":"RE"}]}}
            json_txt = {"jnpr_qmon_ext": {"queue_monitor_element_info"=>[{"if_name"=>"xe-2/0/1", "queue_monitor_stats_ingress"=>{"queue_monitor_stats_info"=>[{"queue_number"=>0, "queue_id"=>32, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>884571044, "octets"=>1167633778080, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>1, "queue_id"=>33, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>2, "queue_id"=>34, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>3, "queue_id"=>35, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>536, "octets"=>45024, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>4, "queue_id"=>36, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>5, "queue_id"=>37, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>6, "queue_id"=>38, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>7, "queue_id"=>39, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}]}, "queue_monitor_stats_egress"=>{"queue_monitor_stats_info"=>[{"queue_number"=>0, "queue_id"=>24, "peak_buffer_occupancy_bytes"=>1298, "peak_buffer_occupancy_percent"=>0, "packets"=>148913767806, "octets"=>196566172833096, "tail_drop_packets"=>3437, "tail_drop_octets"=>4536840, "red_drop_packets_color_0"=>441416731, "red_drop_octets_color_0"=>582670084920, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>1, "queue_id"=>25, "peak_buffer_occupancy_bytes"=>2596, "peak_buffer_occupancy_percent"=>0, "packets"=>415364122768, "octets"=>548280642053760, "tail_drop_packets"=>2107, "tail_drop_octets"=>2781240, "red_drop_packets_color_0"=>353728381, "red_drop_octets_color_0"=>466921462920, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>2, "queue_id"=>26, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>3, "queue_id"=>27, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>4, "queue_id"=>28, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>5, "queue_id"=>29, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>6, "queue_id"=>30, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}, {"queue_number"=>7, "queue_id"=>31, "peak_buffer_occupancy_bytes"=>0, "peak_buffer_occupancy_percent"=>0, "packets"=>0, "octets"=>0, "tail_drop_packets"=>0, "tail_drop_octets"=>0, "red_drop_packets_color_0"=>0, "red_drop_octets_color_0"=>0, "red_drop_packets_color_1"=>0, "red_drop_octets_color_1"=>0, "red_drop_packets_color_2"=>0, "red_drop_octets_color_2"=>0, "red_drop_packets_color_3"=>0, "red_drop_octets_color_3"=>0}]}}]}}
             
            enterp.stubs(:juniperNetworks).returns(jnpr_sensor)
            jnpr_sensor.stubs(:to_json).returns(json_txt)
            jti_msg.stubs(:system_id).returns('A:60.60.60.1')
            jti_msg.stubs(:timestamp).returns('1234567890909')
            jti_msg.stubs(:enterprise).returns(enterp)

            TelemetryStream.any_instance.stubs(:decode).returns(jti_msg)
            enterp.stubs(:juniperNetworks).returns(json_txt)

            parser = Fluent::TextParser::JuniperJtiParser.new

            count = 0
            hostname = Socket.gethostname
            parser.parse({}) {|time, record|
                case count
                    when 0
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>32,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>884571044,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>1167633778080,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 1
                         assert_equal(1234567890, time)
                         assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>1,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>33,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 2
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>2,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>34,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 3
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>3,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>35,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>536,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>45024,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 4
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>4,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>36,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 5
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>5,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>37,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 6
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>6,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>38,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 7
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_number"=>7,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.queue_id"=>39,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_ingress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 8
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>24,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>1298,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>148913767806,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>196566172833096,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>3437,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>4536840,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>441416731,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>582670084920,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 9
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>1,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>25,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>2596,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>415364122768,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>548280642053760,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>2107,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>2781240,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>353728381,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>466921462920,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 10
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>2,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>26,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 11
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>3,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>27,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 12
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>4,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>28,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 13
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>5,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>29,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 14
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>6,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>30,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)
                    when 15
                        assert_equal(1234567890, time)
                        assert_equal({"queue_monitor_element_info.if_name"=>"xe-2/0/1","queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_number"=>7,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.queue_id"=>31,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_bytes"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.peak_buffer_occupancy_percent"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_packets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.tail_drop_octets"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_0"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_1"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_2"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_packets_color_3"=>0,"queue_monitor_element_info.queue_monitor_stats_egress.queue_monitor_stats_info.red_drop_octets_color_3"=>0,"device"=>"A:60.60.60.1","host"=>hostname,"sensor_name"=>"jnpr_qmon_ext", "time"=>1234567890909}, record)

                end
                count += 1
            }
        end

    end
end
